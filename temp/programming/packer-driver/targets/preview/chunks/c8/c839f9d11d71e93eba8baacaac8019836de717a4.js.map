{"version":3,"sources":["file:///Users/shivam/Desktop/FlappyBird/assets/Scripts/GameCtrl.ts"],"names":["_decorator","CCInteger","Component","Node","input","Input","KeyCode","director","Contact2DType","Collider2D","Ground","Results","Bird","BirdAudio","StopResume","PipePool","ccclass","property","GameCtrl","type","tooltip","iniSpeed","iniPipeSpeed","isOver","onLoad","initListener","result","resetScore","pause","speed","pipeSpeed","enableTouch","resetGame","bird","resetBird","startGame","fly","clip","onAudioQueue","on","EventType","KEY_DOWN","onKeyDown","node","TOUCH_START","event","keyCode","KEY_P","stopResume","pauseGame","KEY_R","resumeGame","hideResults","resume","gameOver","showResults","pipeQueue","reset","passPipe","addScore","createPipe","addPool","contactGroundPipe","collider","getComponent","BEGIN_CONTACT","onBeginContact","selfcollider","otherCollider","contact","hitSomething","birdStruck","update","changeSpeed","num"],"mappings":"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","sourcesContent":["import { _decorator, CCInteger, Component, Node, input, Input, EventKeyboard, KeyCode, director, pipeline, Contact2DType, Collider2D, IPhysics2DContact } from 'cc';\nimport { Ground } from './Ground';\nimport { Results } from './Results';\nimport { Bird } from './Bird';\nimport { BirdAudio } from './BirdAudio';\nimport { StopResume } from './StopResume';\n\nimport { PipePool } from './PipePool';\nconst { ccclass, property } = _decorator;\n\n@ccclass('GameCtrl')\nexport class GameCtrl extends Component {\n    @property({\n        type: Ground,\n        tooltip : 'this is ground'\n    })\n    public ground : Ground;\n\n    @property({\n        type: Results,\n        tooltip: 'results go here'\n    })\n    public result : Results\n\n    @property({\n        type:StopResume,\n        tooltip:'stop resume'\n    })\n    public stopResume : StopResume;\n\n    @property({\n        type:Bird\n    })\n    public bird : Bird;\n\n    @property({\n        type:PipePool\n    })\n    public pipeQueue: PipePool;\n\n    @property({\n        type:BirdAudio\n    })\n    public clip : BirdAudio;\n\n    @property({\n        type: CCInteger\n    })\n    public speed : number = 200;\n\n    @property({\n        type:CCInteger\n    })\n    public pipeSpeed : number = 200;\n    private iniSpeed : number;\n    private iniPipeSpeed : number;\n\n    public isOver : boolean;\n\n    protected onLoad(): void {\n        this.initListener();\n        this.result.resetScore();\n        this.isOver = true;\n        director.pause();\n        this.iniSpeed = this.speed;\n        this.iniPipeSpeed = this.pipeSpeed;\n    }\n\n    enableTouch() {\n        if (this.isOver == true) {\n            this.resetGame();\n            this.bird.resetBird();\n            this.startGame();\n        }\n        if (this.isOver == false) {\n            this.bird.fly();\n            this.clip.onAudioQueue(0);\n        }\n    }\n\n    initListener() {\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n        this.node.on(Node.EventType.TOUCH_START, this.enableTouch, this);\n    }\n\n    onKeyDown(event : EventKeyboard) {\n        switch (event.keyCode) {\n            case KeyCode.KEY_P:\n                this.stopResume.pauseGame();\n                break;\n            case KeyCode.KEY_R:\n                this.stopResume.resumeGame();\n                break;\n        }\n    }\n\n    startGame() {\n        this.result.hideResults();\n        director.resume();\n    }\n\n    gameOver() {\n        this.result.showResults();\n        this.isOver = true;\n        this.clip.onAudioQueue(3);\n        director.pause();\n    }\n\n    resetGame() {\n        this.result.resetScore();\n        this.pipeQueue.reset();\n        this.isOver = false;\n        this.startGame();\n    }\n\n    passPipe() {\n        this.result.addScore();\n        this.clip.onAudioQueue(1);\n    }\n\n    createPipe() {\n        this.pipeQueue.addPool();\n    }\n\n    contactGroundPipe() {\n        let collider = this.bird.getComponent(Collider2D);\n        if (collider) {\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n        }\n    }\n\n    onBeginContact(selfcollider: Collider2D, otherCollider : Collider2D, contact : IPhysics2DContact | null) {\n        this.bird.hitSomething = true;\n        this.clip.onAudioQueue(2);\n    }\n\n    birdStruck() {\n        this.contactGroundPipe();\n        if (this.bird.hitSomething == true) {\n            this.gameOver();\n        }\n    }\n\n    update() {\n        if (this.isOver == false) {\n            this.birdStruck();\n        }\n    }\n    \n    changeSpeed(num : number) {\n        if (num == -1) {\n            this.speed = 0;\n            this.pipeSpeed = 0;\n        } else if (num == -2) {\n            this.speed = this.iniSpeed;\n            this.pipeSpeed = this.iniPipeSpeed;\n        } else {\n            this.speed = this.iniSpeed + num * 20;\n            this.pipeSpeed = this.iniPipeSpeed + num * 20;\n        }\n    }\n}\n"]}